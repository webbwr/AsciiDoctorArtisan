# v2.0.0 Document Templates Implementation Plan

**Feature:** Document Template System
**Target:** Built-in + custom templates, 100% test coverage
**Effort Estimate:** 16-24 hours
**Status:** ğŸ“‹ PLANNING

---

## Executive Summary

Implement a comprehensive template system that provides built-in AsciiDoc document templates (article, book, man page) and allows users to create, manage, and share custom templates. Templates will support variables, categories, and live preview to accelerate document creation and enforce consistency.

---

## Requirements

### Functional Requirements

1. **Built-In Templates**
   - **Article** - Standard technical article template
   - **Book** - Multi-chapter book template
   - **Man Page** - Unix manual page template
   - **Technical Report** - Formal report template
   - **README** - GitHub-style README template
   - **Meeting Notes** - Meeting minutes template
   - **Tutorial** - Step-by-step tutorial template
   - **API Documentation** - API reference template

2. **Template Variables**
   - Placeholder substitution: `{{variable_name}}`
   - Common variables: title, author, date, version, description
   - Custom variables per template
   - Default values and validation

3. **Custom Templates**
   - Create from current document
   - Save with metadata (name, description, category, author)
   - Edit existing custom templates
   - Delete custom templates
   - Import/export template files (.adoc + metadata)

4. **Template Management UI**
   - Template browser dialog with preview
   - Search and filter by category/name
   - Template details (description, variables, preview)
   - New document from template wizard
   - Template editor (for custom templates)

5. **Template Categories**
   - General (article, note, letter)
   - Technical (API docs, tutorial, specification)
   - Academic (paper, thesis, report)
   - Project (README, CHANGELOG, CONTRIBUTING)
   - Custom (user-defined categories)

### Non-Functional Requirements

1. **Performance**
   - Template list loads in <100ms
   - Template instantiation <50ms
   - Preview renders in <200ms
   - No impact on application startup

2. **Usability**
   - Simple 3-step wizard: Select â†’ Configure â†’ Create
   - Live preview while editing variables
   - Clear variable descriptions
   - Keyboard shortcuts (Ctrl+N for new from template)

3. **Quality**
   - 100% test coverage for template engine
   - Type-safe implementation (mypy --strict)
   - Comprehensive template library

---

## Technical Architecture

### Component Design

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Template Browser Dialog (UI)            â”‚
â”‚  - Template list (grid/list view)               â”‚
â”‚  - Search and filter controls                   â”‚
â”‚  - Preview pane                                  â”‚
â”‚  - Variable configuration form                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ create_from_template(id, vars)
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       TemplateManager (Controller)              â”‚
â”‚  - Loads built-in and custom templates          â”‚
â”‚  - Manages template CRUD operations              â”‚
â”‚  - Instantiates templates with variables        â”‚
â”‚  - Validates variable values                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ load_templates()
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       TemplateEngine (Business Logic)           â”‚
â”‚  - Variable substitution                        â”‚
â”‚  - Template rendering                           â”‚
â”‚  - Metadata parsing and validation              â”‚
â”‚  - Import/export functionality                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â–¼                 â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Built-in     â”‚ â”‚ Custom       â”‚ â”‚ Template Storage â”‚
â”‚ Templates    â”‚ â”‚ Templates    â”‚ â”‚ - JSON metadata  â”‚
â”‚ (bundled)    â”‚ â”‚ (user)       â”‚ â”‚ - .adoc files    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### File Structure

```
src/asciidoc_artisan/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ templates/
â”‚   â”‚   â”œâ”€â”€ __init__.py                  # Public API exports
â”‚   â”‚   â”œâ”€â”€ template_engine.py           # Core template logic
â”‚   â”‚   â”œâ”€â”€ template_manager.py          # Template CRUD operations
â”‚   â”‚   â”œâ”€â”€ template_metadata.py         # Metadata model
â”‚   â”‚   â”œâ”€â”€ variable_validator.py        # Variable validation
â”‚   â”‚   â””â”€â”€ builtin_templates.py         # Built-in template definitions
â”‚   â””â”€â”€ models.py                         # Add Template model
â”œâ”€â”€ ui/
â”‚   â”œâ”€â”€ template_browser_dialog.py       # Template browser UI
â”‚   â”œâ”€â”€ template_editor_dialog.py        # Template editor UI
â”‚   â””â”€â”€ template_variable_form.py        # Variable input form
â”œâ”€â”€ templates/                            # Built-in template files
â”‚   â”œâ”€â”€ article.adoc
â”‚   â”œâ”€â”€ book.adoc
â”‚   â”œâ”€â”€ man_page.adoc
â”‚   â”œâ”€â”€ technical_report.adoc
â”‚   â”œâ”€â”€ readme.adoc
â”‚   â”œâ”€â”€ meeting_notes.adoc
â”‚   â”œâ”€â”€ tutorial.adoc
â”‚   â””â”€â”€ api_documentation.adoc
â””â”€â”€ tests/unit/core/templates/
    â”œâ”€â”€ test_template_engine.py          # Engine tests
    â”œâ”€â”€ test_template_manager.py         # Manager tests
    â”œâ”€â”€ test_template_metadata.py        # Metadata tests
    â”œâ”€â”€ test_variable_validator.py       # Validation tests
    â””â”€â”€ test_builtin_templates.py        # Built-in template tests
```

---

## Data Models

### Template

```python
@dataclass
class Template:
    """Represents a document template."""

    id: str                      # Unique identifier (UUID for custom, slug for built-in)
    name: str                    # Display name
    description: str             # Template description
    category: TemplateCategory   # Category
    content: str                 # Template content (with {{variables}})
    variables: List[TemplateVariable]  # Variable definitions
    author: str = "AsciiDoc Artisan"  # Template author
    version: str = "1.0.0"       # Template version
    created_at: datetime = field(default_factory=datetime.now)
    updated_at: datetime = field(default_factory=datetime.now)
    is_builtin: bool = False     # Built-in vs. custom
    preview_image: Optional[str] = None  # Preview thumbnail path

class TemplateCategory(Enum):
    """Template categories."""
    GENERAL = "general"
    TECHNICAL = "technical"
    ACADEMIC = "academic"
    PROJECT = "project"
    CUSTOM = "custom"
```

### TemplateVariable

```python
@dataclass
class TemplateVariable:
    """Variable definition in a template."""

    name: str                    # Variable name (e.g., "author")
    label: str                   # Display label
    description: str             # Help text
    default_value: str = ""      # Default value
    required: bool = True        # Required field?
    validation: Optional[str] = None  # Regex validation pattern
    variable_type: VariableType = VariableType.TEXT  # Input type

class VariableType(Enum):
    """Types of template variables."""
    TEXT = "text"           # Single-line text
    MULTILINE = "multiline" # Multi-line text
    DATE = "date"           # Date picker
    EMAIL = "email"         # Email validation
    URL = "url"             # URL validation
    NUMBER = "number"       # Numeric input
    CHOICE = "choice"       # Dropdown selection
```

### TemplateMetadata

```python
@dataclass
class TemplateMetadata:
    """Metadata stored with custom templates."""

    id: str
    name: str
    description: str
    category: str
    author: str
    version: str
    created_at: str
    updated_at: str
    variables: List[Dict[str, Any]]  # Serialized TemplateVariable list
    content_path: str                # Relative path to .adoc file
```

---

## Built-In Templates

### 1. Article Template

```asciidoc
= {{title}}
{{author}} <{{email}}>
v{{version}}, {{date}}
:toc:
:icons: font
:source-highlighter: pygments

== Introduction

{{introduction}}

== {{section1_title}}

{{section1_content}}

== {{section2_title}}

{{section2_content}}

== Conclusion

{{conclusion}}
```

**Variables:**
- `title` (required) - Document title
- `author` (required) - Author name
- `email` (optional) - Author email
- `version` (default: "1.0") - Document version
- `date` (default: today) - Publication date
- `introduction` (required) - Introduction paragraph
- `section1_title`, `section1_content` - First section
- `section2_title`, `section2_content` - Second section
- `conclusion` (required) - Concluding paragraph

### 2. Book Template

```asciidoc
= {{book_title}}
{{author}}
v{{version}}, {{date}}
:doctype: book
:toc:
:toclevels: 2
:sectnums:

[preface]
== Preface

{{preface}}

[dedication]
== Dedication

{{dedication}}

= Part I: {{part1_title}}

== Chapter 1: {{chapter1_title}}

{{chapter1_content}}

== Chapter 2: {{chapter2_title}}

{{chapter2_content}}

= Part II: {{part2_title}}

== Chapter 3: {{chapter3_title}}

{{chapter3_content}}

[appendix]
== Appendix A: {{appendix_title}}

{{appendix_content}}

[index]
== Index
```

### 3. Man Page Template

```asciidoc
= {{command_name}}({{section}})
:doctype: manpage
:man manual: {{manual_name}}
:man source: {{source_name}}

== NAME

{{command_name}} - {{brief_description}}

== SYNOPSIS

{{command_name}} [OPTION]... [FILE]...

== DESCRIPTION

{{description}}

== OPTIONS

*-h*, *--help*::
    {{help_option}}

*-v*, *--version*::
    {{version_option}}

== EXAMPLES

{{examples}}

== SEE ALSO

{{see_also}}

== AUTHOR

{{author}}
```

### 4. README Template

```asciidoc
= {{project_name}}

{{tagline}}

image:https://img.shields.io/badge/version-{{version}}-blue.svg[]
image:https://img.shields.io/badge/license-{{license}}-green.svg[]

== Overview

{{overview}}

== Features

* {{feature1}}
* {{feature2}}
* {{feature3}}

== Installation

[source,bash]
----
{{install_command}}
----

== Usage

[source,{{language}}]
----
{{usage_example}}
----

== Documentation

{{documentation_link}}

== Contributing

{{contributing_info}}

== License

{{license_info}}

== Contact

{{contact_info}}
```

---

## Implementation Phases

### Phase 1: Core Template Engine (5-7h)

**Deliverables:**
- `template_engine.py` with variable substitution
- `template_metadata.py` with data models
- `variable_validator.py` with validation logic
- Unit tests (25+ tests)

**Key Methods:**
- `TemplateEngine.render(template: Template, variables: Dict[str, str]) -> str`
- `TemplateEngine.parse_variables(content: str) -> List[str]`
- `VariableValidator.validate(value: str, variable: TemplateVariable) -> bool`

**Success Criteria:**
- Variable substitution works correctly
- Validation enforces required fields
- Handles missing variables gracefully

### Phase 2: Template Manager (4-6h)

**Deliverables:**
- `template_manager.py` with CRUD operations
- `builtin_templates.py` with 8 built-in templates
- Template storage (JSON + .adoc files)
- Manager tests (20+ tests)

**Key Methods:**
- `TemplateManager.load_builtin_templates() -> List[Template]`
- `TemplateManager.load_custom_templates() -> List[Template]`
- `TemplateManager.save_custom_template(template: Template)`
- `TemplateManager.delete_custom_template(template_id: str)`

**Success Criteria:**
- Built-in templates load correctly
- Custom templates persist across sessions
- Import/export works for template sharing

### Phase 3: UI Components (5-8h)

**Deliverables:**
- `template_browser_dialog.py` - Main template UI
- `template_editor_dialog.py` - Template creation/editing
- `template_variable_form.py` - Variable input form
- UI tests (20+ tests)

**Key Components:**
- Template grid with thumbnails
- Search and filter controls
- Live preview pane
- Variable configuration form with validation

**Success Criteria:**
- Template selection is intuitive
- Variable form validates in real-time
- Preview updates as variables change
- New document created from template

### Phase 4: Built-In Templates (2-3h)

**Deliverables:**
- 8 built-in template files (.adoc)
- Template metadata definitions
- Preview thumbnails (optional)
- Template documentation

**Templates:**
1. Article
2. Book
3. Man Page
4. Technical Report
5. README
6. Meeting Notes
7. Tutorial
8. API Documentation

**Success Criteria:**
- All templates render correctly
- Variables are well-documented
- Templates follow AsciiDoc best practices

---

## Template Variable Substitution

### Algorithm

```python
def render(template: Template, variables: Dict[str, str]) -> str:
    """
    Render template with variable substitution.

    Variables are specified as {{variable_name}} in template content.
    """
    content = template.content

    # Validate required variables
    for var in template.variables:
        if var.required and var.name not in variables:
            raise ValueError(f"Required variable '{var.name}' not provided")

    # Apply default values
    for var in template.variables:
        if var.name not in variables and var.default_value:
            variables[var.name] = var.default_value

    # Substitute variables
    for var_name, var_value in variables.items():
        placeholder = f"{{{{{var_name}}}}}"  # {{var_name}}
        content = content.replace(placeholder, var_value)

    # Check for unresolved variables
    unresolved = re.findall(r'\{\{(\w+)\}\}', content)
    if unresolved:
        logger.warning(f"Unresolved variables: {unresolved}")
        # Replace with empty string or leave as-is
        for var in unresolved:
            content = content.replace(f"{{{{{var}}}}}", "")

    return content
```

### Variable Validation

```python
def validate_variable(value: str, variable: TemplateVariable) -> Tuple[bool, Optional[str]]:
    """
    Validate variable value according to type and pattern.

    Returns (is_valid, error_message).
    """
    # Required check
    if variable.required and not value.strip():
        return False, f"{variable.label} is required"

    # Type-specific validation
    if variable.variable_type == VariableType.EMAIL:
        if not re.match(r'^[\w\.-]+@[\w\.-]+\.\w+$', value):
            return False, "Invalid email format"

    elif variable.variable_type == VariableType.URL:
        if not value.startswith(('http://', 'https://')):
            return False, "URL must start with http:// or https://"

    elif variable.variable_type == VariableType.NUMBER:
        try:
            float(value)
        except ValueError:
            return False, "Must be a number"

    elif variable.variable_type == VariableType.DATE:
        try:
            datetime.strptime(value, '%Y-%m-%d')
        except ValueError:
            return False, "Date must be in YYYY-MM-DD format"

    # Custom regex validation
    if variable.validation:
        if not re.match(variable.validation, value):
            return False, f"Must match pattern: {variable.validation}"

    return True, None
```

---

## Template Storage

### Custom Template Storage

**Location:** `~/.config/AsciiDocArtisan/templates/`

**Structure:**
```
templates/
â”œâ”€â”€ metadata.json               # Index of all custom templates
â”œâ”€â”€ custom-template-1/
â”‚   â”œâ”€â”€ template.adoc
â”‚   â””â”€â”€ preview.png (optional)
â”œâ”€â”€ custom-template-2/
â”‚   â”œâ”€â”€ template.adoc
â”‚   â””â”€â”€ preview.png
â””â”€â”€ ...
```

**metadata.json:**
```json
{
  "version": "1.0",
  "templates": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "name": "Custom Article",
      "description": "My custom article template",
      "category": "custom",
      "author": "User Name",
      "version": "1.0.0",
      "created_at": "2025-11-05T12:00:00Z",
      "updated_at": "2025-11-05T12:00:00Z",
      "content_path": "custom-template-1/template.adoc",
      "variables": [
        {
          "name": "title",
          "label": "Title",
          "description": "Document title",
          "required": true,
          "variable_type": "text"
        }
      ]
    }
  ]
}
```

### Built-In Template Storage

**Location:** `src/asciidoc_artisan/templates/`

Templates bundled with application, read-only.

---

## User Experience

### Template Browser Dialog

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ New Document from Template                           [X]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search: [_______________] Category: [All â–¼] [Built-in â–¼]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚ Article Template                    â”‚
â”‚ â”‚ Article â”‚ â—        â”‚                                     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ Standard technical article with:    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚ - Title, author, version            â”‚
â”‚ â”‚  Book   â”‚          â”‚ - Introduction and conclusion       â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ - Two customizable sections         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚                                     â”‚
â”‚ â”‚ Man Pageâ”‚          â”‚ Variables (6):                      â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ â€¢ Title (required)                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚ â€¢ Author (required)                 â”‚
â”‚ â”‚Technicalâ”‚          â”‚ â€¢ Email (optional)                  â”‚
â”‚ â”‚ Report  â”‚          â”‚ â€¢ ...                               â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚                                     â”‚
â”‚                      â”‚ [Preview]                           â”‚
â”‚ [+ New Template]     â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      [Cancel] [Use Template]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Variable Configuration Form

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Configure Template Variables                        [X]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Title *                                                    â”‚
â”‚ [My Article Title________________________]                 â”‚
â”‚                                                            â”‚
â”‚ Author *                                                   â”‚
â”‚ [John Doe____________________________]                     â”‚
â”‚                                                            â”‚
â”‚ Email                                                      â”‚
â”‚ [john@example.com____________________]                     â”‚
â”‚                                                            â”‚
â”‚ Version                                                    â”‚
â”‚ [1.0] (default)                                            â”‚
â”‚                                                            â”‚
â”‚ Date                                                       â”‚
â”‚ [2025-11-05] [ğŸ“…]                                          â”‚
â”‚                                                            â”‚
â”‚ Introduction *                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚ â”‚This article introduces...          â”‚                    â”‚
â”‚ â”‚                                    â”‚                    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                            â”‚
â”‚ * Required fields                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          [Cancel] [Create] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Menu Integration

```
File â†’ New from Template... (Ctrl+Shift+N)
File â†’ Save as Template...
Tools â†’ Manage Templates...
```

### Settings Integration

```python
# Settings model additions
template_directory: Path = Path("~/.config/AsciiDocArtisan/templates")
template_default_category: str = "general"
template_show_preview: bool = True
template_auto_fill_metadata: bool = True  # Auto-fill author, date
```

---

## Testing Strategy

### Unit Tests (65+ tests)

1. **TemplateEngine** (15 tests)
   - Variable substitution
   - Default value handling
   - Unresolved variable handling
   - Edge cases (empty templates, no variables)

2. **TemplateManager** (20 tests)
   - Load built-in templates
   - Load custom templates
   - Save/delete custom templates
   - Import/export functionality

3. **VariableValidator** (15 tests)
   - Required field validation
   - Type-specific validation (email, URL, date, number)
   - Regex pattern validation
   - Edge cases

4. **BuiltInTemplates** (15 tests)
   - Each template renders correctly
   - Variable definitions are complete
   - Metadata is valid

### Integration Tests (15 tests)

- Full workflow: Browse â†’ Select â†’ Configure â†’ Create
- Template import/export
- Custom template CRUD operations
- Settings integration

### UI Tests (10 tests)

- Template browser dialog
- Variable form validation
- Search and filter
- Preview rendering

---

## Performance Optimization

### Strategy

1. **Lazy Loading**
   - Load built-in templates only when browser opened
   - Cache loaded templates in memory

2. **Incremental Rendering**
   - Preview renders only visible portion
   - Debounce preview updates (300ms)

3. **Efficient Storage**
   - Store metadata separately from content
   - Use JSON for fast metadata access

### Performance Budget

| Operation | Target | Max |
|-----------|--------|-----|
| Load template list | <50ms | 100ms |
| Render template | <20ms | 50ms |
| Preview generation | <100ms | 200ms |
| Save custom template | <50ms | 100ms |

---

## Success Metrics

### Quantitative

- Template instantiation: <50ms âœ…
- Test coverage: 100% âœ…
- Built-in templates: 8+ âœ…
- User adoption: >40% use templates within 1 month

### Qualitative

- User feedback: Positive sentiment
- Template quality: Professional appearance
- Ease of use: <2 minutes to create document
- Customization: Users create custom templates

---

## Future Enhancements (Post-v2.0.0)

1. **Template Marketplace** (v2.1+)
   - Community template sharing
   - Template ratings and reviews
   - One-click template installation

2. **Advanced Variables** (v2.2+)
   - Conditional sections
   - Loops for repeating content
   - Computed variables (date math, string operations)

3. **Template Inheritance** (v3.0+)
   - Base templates with overrides
   - Template composition
   - Partial templates (includes)

4. **AI-Generated Templates** (v3.0+)
   - Generate template from description
   - Suggest improvements to custom templates
   - Auto-categorization

---

## References

### Template Systems

- [Jinja2 Templates](https://jinja.palletsprojects.com/)
- [Mustache Templates](https://mustache.github.io/)
- [AsciiDoc Templates](https://docs.asciidoctor.org/asciidoc/latest/document/document-templates/)

### Qt Documentation

- [QWizard](https://doc.qt.io/qt-6/qwizard.html) - Wizard interface
- [QListWidget](https://doc.qt.io/qt-6/qlistwidget.html) - Template list
- [QFormLayout](https://doc.qt.io/qt-6/qformlayout.html) - Variable form

---

**Next Steps:**

1. âœ… Create this plan document
2. Review template designs
3. Set up development branch: `feature/v2.0.0-templates`
4. Begin Phase 1: Core Template Engine
5. Iterate based on testing and feedback

---

**Last Updated:** November 5, 2025
**Author:** v2.0.0 Development Initiative
**Status:** ğŸ“‹ PLANNING â†’ Ready for Phase 1 Implementation

